# Scan all Jenkins Jobs and remove given email id
$Email = $ENV:Email
$Servers = $ENV:Servers -split ','

foreach($Server in $Servers) {
    ""
    "Server = $Server"

    $JobsPath = "\\$Server\d$\VitalAxis\Jenkins_Build\ORION\bin\Jenkins_Jobs\DevOps\Jenkins_Jobs_Categorized_By_Jenkins_Servers\$Server"
    $JobsRoot = "\\$Server\c$\ProgramData\Jenkins\.jenkins\jobs"

    [System.Array] $Jobs = Get-ChildItem -File -Recurse -LiteralPath $JobsPath

    $Count = 0

    foreach($Job in $Jobs){
        $FileContent = ''
        $JobFile = ''

        $JobFile = $Job.FullName.Replace($JobsPath, $JobsRoot)

        if(Test-Path $JobFile){
            $FileContent = Get-Content -Raw -LiteralPath $JobFile
            if($FileContent -match $Email){
                $Count++;
                "Removing email id in: $($Job.FullName.Replace($JobsPath, ''))"

                $FileContent = $FileContent -replace ("$Email,", '') -replace (",$Email", '')
                $FileContent = $FileContent -replace ("$Email", '')
        
                [System.IO.File]::WriteAllText($JobFile, $FileContent)
            }
        }
    }

    if($Count -gt 0){
        ""
        "Removed Email $Email in $Count job(s)"
    }
    else{
        ""
        "Found Email $Email in $Count job(s)"
    }
}
################################Full For Reference###########################################
Skip to content
[Jenkins]Jenkins
Search (CTRL+K)
5
3
Udaykumar T

log out
Dashboard
ORION
Remove-EmailIdInJenkinsEmailNotification
Configuration
Configure

General

Source Code Management

Build Triggers

Build Environment

Build Steps

Post-build Actions

General

Description
Scan all Jenkins Jobs and remove given email id.
( Restart Jenkins Service after running this Job )
Plain text
Preview

Enable project-based security

Discard old builds
?
GitLab Connection


Use alternative credential

This project is parameterized
?
String Parameter
?

Name
?
Email
Default Value
?
Description
?
Email Id to search and remove from Jenkins Build Job Email Notifications.
Example: orion@starmarkit.com
Plain text
Preview

Trim the string
?
Active Choices Parameter
?

Name
Servers
Script
Groovy Script
?
Script
Groovy Script
return [
    '192.168.168.129:selected',
    '192.168.168.130:selected',
    '192.168.168.131:selected',
    '192.168.168.133:selected'
]
The script is already approved

Use Groovy Sandbox
?
Additional classpath
?
Add entry
Fallback Script
Groovy Script
return ['-']
The script is already approved

Use Groovy Sandbox
?
Additional classpath
?
Add entry
Description
?
Jenkins Server
Choice Type

Check Boxes

Enable filters
?
Filter starts at
?
1
Add Parameter

Throttle builds
?
Job config history change message
?

Execute concurrent builds if necessary
?
JDK
JDK to be used for this project

(System)

Restrict where this project can be run
?
Advanced
Source Code Management
None
Git
?
Build Triggers

Trigger builds remotely (e.g., from scripts)
?

Build after other projects are built
?

Build periodically
?

Build when a change is pushed to GitLab. GitLab webhook URL: http://192.168.168.133:8080/project/ORION/Remove-EmailIdInJenkinsEmailNotification
?

Enable Artifactory trigger

Poll SCM
?
Build Environment

Delete workspace before build starts

Mask passwords and regexes (and enable global passwords)
?

Use secret text(s) or file(s)
?

Provide Configuration files
?

Add timestamps to the Console Output

Ant/Ivy-Artifactory Integration

Generic-Artifactory Integration

Gradle-Artifactory Integration

Inspect build log for published build scans

Maven3-Artifactory Integration

Set jenkins user build variables
?

With Ant
?
Build Steps
PowerShell
?

Command
See the list of available environment variables
# Scan all Jenkins Jobs and remove given email id
$Email = $ENV:Email
$Servers = $ENV:Servers -split ','

foreach($Server in $Servers) {
    ""
    "Server = $Server"

    $JobsPath = "\\$Server\d$\VitalAxis\Jenkins_Build\ORION\bin\Jenkins_Jobs\DevOps\Jenkins_Jobs_Categorized_By_Jenkins_Servers\$Server"
    $JobsRoot = "\\$Server\c$\ProgramData\Jenkins\.jenkins\jobs"

    [System.Array] $Jobs = Get-ChildItem -File -Recurse -LiteralPath $JobsPath

    $Count = 0

    foreach($Job in $Jobs){
        $FileContent = ''
        $JobFile = ''

        $JobFile = $Job.FullName.Replace($JobsPath, $JobsRoot)

        if(Test-Path $JobFile){
            $FileContent = Get-Content -Raw -LiteralPath $JobFile
            if($FileContent -match $Email){
                $Count++;
                "Removing email id in: $($Job.FullName.Replace($JobsPath, ''))"

                $FileContent = $FileContent -replace ("$Email,", '') -replace (",$Email", '')
                $FileContent = $FileContent -replace ("$Email", '')
        
                [System.IO.File]::WriteAllText($JobFile, $FileContent)
            }
        }
    }

    if($Count -gt 0){
        ""
        "Removed Email $Email in $Count job(s)"
    }
    else{
        ""
        "Found Email $Email in $Count job(s)"
    }
}

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
# Scan all Jenkins Jobs and remove given email id
$Email = $ENV:Email
$Servers = $ENV:Servers -split ','
 
foreach($Server in $Servers) {
    ""
    "Server = $Server"
 
    $JobsPath = "\\$Server\d$\VitalAxis\Jenkins_Build\ORION\bin\Jenkins_Jobs\DevOps\Jenkins_Jobs_Categorized_By_Jenkins_Servers\$Server"
    $JobsRoot = "\\$Server\c$\ProgramData\Jenkins\.jenkins\jobs"
 
    [System.Array] $Jobs = Get-ChildItem -File -Recurse -LiteralPath $JobsPath
 
    $Count = 0
 
    foreach($Job in $Jobs){
        $FileContent = ''
        $JobFile = ''
 
        $JobFile = $Job.FullName.Replace($JobsPath, $JobsRoot)
 
        if(Test-Path $JobFile){
            $FileContent = Get-Content -Raw -LiteralPath $JobFile
            if($FileContent -match $Email){
                $Count++;
                "Removing email id in: $($Job.FullName.Replace($JobsPath, ''))"
 
                $FileContent = $FileContent -replace ("$Email,", '') -replace (",$Email", '')
                $FileContent = $FileContent -replace ("$Email", '')
        
                [System.IO.File]::WriteAllText($JobFile, $FileContent)
            }
        }
    }
 
    if($Count -gt 0){
        ""
        "Removed Email $Email in $Count job(s)"
    }
    else{
        ""
        "Found Email $Email in $Count job(s)"
    }
}
 

Stop On Errors
?

Use PowerShell profile
?
Advanced
Add build step
Post-build Actions
Add post-build action
Save
Apply
REST API
Jenkins 2.452.1
